<?xml version="1.0" encoding="utf-8"?>
<odoo>
     <data noupdate="1">

        <record id="rm_permintaan_masuk_rs" model="cdn.erm.daftar">
            <field name="name">Surat Permintaan Masuk Rumah Sakit</field>
            <field name="no_rekam_medis">1</field> 
            <field name="model_rm_id" ref="model_cdn_permintaan_masuk_rs"/>
        </record>

    </data>
    <data>
    
        <record id="view_permintaan_masuk_rs_form" model="ir.ui.view">
            <field name="name">cdn.permintaan.masuk.rs.form</field>
            <field name="model">cdn.permintaan.masuk.rs</field>
            <field name="inherit_id" ref="cdn_erm_base.view_form_erm_base"/>
            <field name="mode">primary</field>
            <field name="arch" type="xml">
                <separator name="form_title_rm" position="attributes">
                    <attribute name="string">SURAT PERMINTAAN MASUK RUMAH SAKIT</attribute>
                </separator>
                
                <xpath expr="//group[@name='dynamic_field']" position="replace">
                     <field name="erm_properties"/>
                    
                    <group name="data_pasien" string="Diisi oleh">
                        <field name="diisi_oleh_dokter"/>
                    </group>
                    
                    <group name="data_pasien_detail" string="Data Pasien">
                        <field name="nama_pasien"/>
                        <field name="umur_tgl_lahir"/>
                        <field name="no_rm"/>

                        <hr/>

                        <field name="alamat"/>
                        <field name="tlp_hp"/>
                        <field name="no_id_card_ktp"/>
                        <field name="penjamin_biaya"/>
                        <field name="diagnosa_kerja"/>
                        <field name="indikasi_masuk" widget="radio" options="{'horizontal': true}"/>
                        <field name="indikasi_lain" invisible="indikasi_masuk != 'lain'" required="indikasi_masuk == 'lain'"/>
                        <field name="keterangan_indikasi"/>
                        <field name="ruangan_dituju"/>
                        <field name="dpjp"/>
                        <field name="tlp_hp"/>
                    </group>
                    <group>
                        <group string="Obat yang Sudah Diberikan">
                            <field name="line" nolabel="1">
                                <list editable="bottom">
                                    <field name="no"/>
                                    <field name="keterangan"/>
                                    <field name="lanjut"/>
                                    <field name="stop"/>
                                </list>
                            </field>
                        </group>

                        <group string="Pemeriksaan yang Sudah Ada">
                            
                            <field name="line" nolabel="1">
                                <list editable="bottom">
                                    <field name="no"/>
                                    <field name="lab_usg_rongten"/>
                                </list>
                            </field>
                        </group>
                    </group>
                            
                    
                    
                    

                    <separator string="Rencana Tata Laksana Klinis"/>
                    <field name="rencana_tata_laksana" nolabel="1"/>
                    
                    <group name="tanda_tangan">
                        <group>
                            <!-- <label for="dpjp_signature" string="DPJP"/>
                            <field name="dpjp_signature" widget="signature" nolabel="1"/> -->
                            <!-- ==================== DOKTER ==================== -->
                            <label for="qr_ttd_dokter_id" string="TTD Dokter"/>

                            <div name="qr_ttd_dokter_id">
                                <field name="qr_ttd_dokter_id" readonly="1" invisible="not qr_ttd_dokter_id" />
                                <field name="qr_ttd_dokter_date" invisible="not qr_ttd_dokter_id" />
                                <field name="qr_ttd_dokter_code" style="width: 150px; height: 150px; object-fit: contain;" widget="image"  invisible="not qr_ttd_dokter_id"
                                    />
                                <field name="qr_ttd_dokter_partner_id" invisible="not qr_ttd_dokter_id" />

                                <button name="signature_generate"
                                        string="Tanda Tangani"
                                        type="object"
                                        class="oe_highlight mt-2"
                                        context="{
                                            'tipe_nakes'    : 'Dokter', 
                                            'field_name'    : 'qr_ttd_dokter_id',
                                            'dokumen'       : 'RM Tandatangan Surat Permintaan Masuk RS',
                                            'perihal'       : 'Tanda tangan pernyataan tindakan medis pada RM Tandatangan Surat Permintaan Masuk RS'
                                            }"
                                        invisible="qr_ttd_dokter_id"
                                        />
                            </div>
                        </group>
                        <group>
                            <field name="tempat_tgl" placeholder="Tempat, Tanggal"/>
                            <label for="pasien_keluarga_signature" string="Pasien/Keluarga"/>
                            <field name="pasien_keluarga_signature" widget="signature" nolabel="1"/>
                        </group>
                    </group>

                </xpath>
            </field>
        </record>

    </data>
</odoo>